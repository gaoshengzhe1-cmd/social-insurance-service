-- 彻底修复源泉税表问题
-- 先删除表
DROP TABLE IF EXISTS income_tax_bracket;

-- 重新创建表，确保没有约束问题
CREATE TABLE income_tax_bracket (
    id BIGSERIAL PRIMARY KEY,
    min_salary INTEGER NOT NULL,
    max_salary INTEGER NOT NULL,
    dependents_0 INTEGER NOT NULL DEFAULT 0,
    dependents_1 INTEGER NOT NULL DEFAULT 0,
    dependents_2 INTEGER NOT NULL DEFAULT 0,
    dependents_3 INTEGER NOT NULL DEFAULT 0,
    dependents_4 INTEGER NOT NULL DEFAULT 0,
    dependents_5 INTEGER NOT NULL DEFAULT 0,
    dependents_6 INTEGER NOT NULL DEFAULT 0,
    dependents_7 INTEGER NOT NULL DEFAULT 0,
    tax_amount_col_b INTEGER NOT NULL DEFAULT 0
);

-- 创建索引以优化查询
CREATE INDEX idx_income_tax_bracket_salary ON income_tax_bracket (min_salary, max_salary);

-- 新しいデータを挿入
INSERT INTO income_tax_bracket 
(min_salary, max_salary, dependents_0, dependents_1, dependents_2, dependents_3, dependents_4, dependents_5, dependents_6, dependents_7, tax_amount_col_b)
VALUES
(88000, 89000, 130, 0, 0, 0, 0, 0, 0, 0, 3200),
(89000, 90000, 180, 0, 0, 0, 0, 0, 0, 0, 3200),
(90000, 91000, 230, 0, 0, 0, 0, 0, 0, 0, 3200),
(91000, 92000, 290, 0, 0, 0, 0, 0, 0, 0, 3200),
(92000, 93000, 340, 0, 0, 0, 0, 0, 0, 0, 3300),
(93000, 94000, 390, 0, 0, 0, 0, 0, 0, 0, 3300),
(94000, 95000, 440, 0, 0, 0, 0, 0, 0, 0, 3300),
(95000, 96000, 490, 0, 0, 0, 0, 0, 0, 0, 3300),
(96000, 97000, 540, 0, 0, 0, 0, 0, 0, 0, 3300),
(97000, 98000, 590, 0, 0, 0, 0, 0, 0, 0, 3300),
(98000, 99000, 640, 0, 0, 0, 0, 0, 0, 0, 3300),
(99000, 100000, 690, 0, 0, 0, 0, 0, 0, 0, 3300),
(100000, 101000, 740, 0, 0, 0, 0, 0, 0, 0, 3300),
(101000, 102000, 790, 0, 0, 0, 0, 0, 0, 0, 3300),
(102000, 103000, 840, 0, 0, 0, 0, 0, 0, 0, 3300),
(103000, 104000, 890, 0, 0, 0, 0, 0, 0, 0, 3300),
(104000, 105000, 940, 0, 0, 0, 0, 0, 0, 0, 3300),
(105000, 106000, 990, 0, 0, 0, 0, 0, 0, 0, 3400),
(106000, 107000, 1040, 0, 0, 0, 0, 0, 0, 0, 3400),
(107000, 108000, 1090, 0, 0, 0, 0, 0, 0, 0, 3400),
(108000, 109000, 1140, 0, 0, 0, 0, 0, 0, 0, 3400),
(109000, 110000, 1190, 0, 0, 0, 0, 0, 0, 0, 3400),
(110000, 111000, 1240, 0, 0, 0, 0, 0, 0, 0, 3400),
(111000, 112000, 1290, 0, 0, 0, 0, 0, 0, 0, 3400),
(112000, 113000, 1340, 0, 0, 0, 0, 0, 0, 0, 3400),
(113000, 114000, 1390, 0, 0, 0, 0, 0, 0, 0, 3400),
(114000, 115000, 1440, 0, 0, 0, 0, 0, 0, 0, 3400),
(115000, 116000, 1490, 0, 0, 0, 0, 0, 0, 0, 3500),
(116000, 117000, 1540, 0, 0, 0, 0, 0, 0, 0, 3500),
(117000, 118000, 1590, 0, 0, 0, 0, 0, 0, 0, 3500),
(118000, 119000, 1640, 0, 0, 0, 0, 0, 0, 0, 3500),
(119000, 120000, 1690, 0, 0, 0, 0, 0, 0, 0, 3500)
(140000, 141000, 2740, 0, 0, 0, 0, 0, 0, 0, 3700),
(141000, 142000, 2790, 0, 0, 0, 0, 0, 0, 0, 3700),
(142000, 143000, 2840, 0, 0, 0, 0, 0, 0, 0, 3700),
(143000, 144000, 2890, 0, 0, 0, 0, 0, 0, 0, 3700),
(144000, 145000, 2940, 0, 0, 0, 0, 0, 0, 0, 3700),
(145000, 146000, 2990, 0, 0, 0, 0, 0, 0, 0, 3800),
(146000, 147000, 3040, 0, 0, 0, 0, 0, 0, 0, 3800),
(147000, 148000, 3090, 0, 0, 0, 0, 0, 0, 0, 3800),
(148000, 149000, 3140, 0, 0, 0, 0, 0, 0, 0, 3800),
(149000, 150000, 3190, 0, 0, 0, 0, 0, 0, 0, 3800),
(150000, 151000, 3240, 0, 0, 0, 0, 0, 0, 0, 3800),
(151000, 152000, 3290, 0, 0, 0, 0, 0, 0, 0, 3800),
(152000, 153000, 3340, 0, 0, 0, 0, 0, 0, 0, 3800),
(153000, 154000, 3390, 0, 0, 0, 0, 0, 0, 0, 3800),
(154000, 155000, 3440, 0, 0, 0, 0, 0, 0, 0, 3800),
(155000, 156000, 3490, 0, 0, 0, 0, 0, 0, 0, 3900),
(156000, 157000, 3540, 0, 0, 0, 0, 0, 0, 0, 3900),
(157000, 158000, 3590, 0, 0, 0, 0, 0, 0, 0, 3900),
(158000, 159000, 3640, 0, 0, 0, 0, 0, 0, 0, 3900),
(159000, 160000, 3690, 0, 0, 0, 0, 0, 0, 0, 3900),
(167000, 169000, 3620, 2000, 390, 0, 0, 0, 0, 0, 11400),
(169000, 171000, 3700, 2070, 460, 0, 0, 0, 0, 0, 11700),
(171000, 173000, 3770, 2140, 530, 0, 0, 0, 0, 0, 12000),
(173000, 175000, 3840, 2220, 600, 0, 0, 0, 0, 0, 12400),
(175000, 177000, 3910, 2290, 670, 0, 0, 0, 0, 0, 12700),
(177000, 179000, 3980, 2360, 750, 0, 0, 0, 0, 0, 13200),
(179000, 181000, 4050, 2430, 820, 0, 0, 0, 0, 0, 13900),
(181000, 183000, 4120, 2500, 890, 0, 0, 0, 0, 0, 14600),
(183000, 185000, 4200, 2570, 960, 0, 0, 0, 0, 0, 15300),
(185000, 187000, 4270, 2640, 1030, 0, 0, 0, 0, 0, 16000),
(187000, 189000, 4340, 2720, 1100, 0, 0, 0, 0, 0, 16700),
(189000, 191000, 4410, 2790, 1170, 0, 0, 0, 0, 0, 17500),
(191000, 193000, 4480, 2860, 1250, 0, 0, 0, 0, 0, 18100),
(193000, 195000, 4550, 2930, 1320, 0, 0, 0, 0, 0, 18800),
(195000, 197000, 4630, 3000, 1390, 0, 0, 0, 0, 0, 19500),
(197000, 199000, 4700, 3070, 1460, 0, 0, 0, 0, 0, 20200),
(199000, 201000, 4770, 3140, 1530, 0, 0, 0, 0, 0, 20900),
(201000, 203000, 4840, 3220, 1600, 0, 0, 0, 0, 0, 21500),
(203000, 205000, 4910, 3290, 1670, 0, 0, 0, 0, 0, 22200),
(205000, 207000, 4980, 3360, 1750, 130, 0, 0, 0, 0, 22700),
(207000, 209000, 5050, 3430, 1820, 200, 0, 0, 0, 0, 23300),
(209000, 211000, 5130, 3500, 1890, 280, 0, 0, 0, 0, 23900),
(211000, 213000, 5200, 3570, 1960, 350, 0, 0, 0, 0, 24400),
(213000, 215000, 5270, 3640, 2030, 420, 0, 0, 0, 0, 25000),
(215000, 217000, 5340, 3720, 2100, 490, 0, 0, 0, 0, 25500),
(217000, 219000, 5410, 3790, 2170, 560, 0, 0, 0, 0, 26100),
(219000, 221000, 5480, 3860, 2250, 630, 0, 0, 0, 0, 26800),
(221000, 224000, 5560, 3950, 2340, 710, 0, 0, 0, 0, 27400),
(224000, 227000, 5680, 4060, 2440, 830, 0, 0, 0, 0, 28400),
(227000, 230000, 5780, 4170, 2550, 930, 0, 0, 0, 0, 29300),
(230000, 233000, 5890, 4280, 2650, 1040, 0, 0, 0, 0, 30300),
(233000, 236000, 5990, 4380, 2770, 1140, 0, 0, 0, 0, 31300),
(236000, 239000, 6110, 4490, 2870, 1260, 0, 0, 0, 0, 32400),
(239000, 242000, 6210, 4590, 2980, 1360, 0, 0, 0, 0, 33400),
(242000, 245000, 6320, 4710, 3080, 1470, 0, 0, 0, 0, 34400),
(245000, 248000, 6420, 4810, 3200, 1570, 0, 0, 0, 0, 35400),
(248000, 251000, 6530, 4920, 3300, 1680, 0, 0, 0, 0, 36400),
(251000, 254000, 6640, 5020, 3410, 1790, 170, 0, 0, 0, 37500),
(254000, 257000, 6750, 5140, 3510, 1900, 290, 0, 0, 0, 38500),
(257000, 260000, 6850, 5240, 3620, 2000, 390, 0, 0, 0, 39400),
(260000, 263000, 6960, 5350, 3730, 2110, 500, 0, 0, 0, 40400),
(263000, 266000, 7070, 5450, 3840, 2220, 600, 0, 0, 0, 41500),
(266000, 269000, 7180, 5560, 3940, 2330, 710, 0, 0, 0, 42500),
(269000, 272000, 7280, 5670, 4050, 2430, 820, 0, 0, 0, 43500),
(272000, 275000, 7390, 5780, 4160, 2540, 930, 0, 0, 0, 44500),
(275000, 278000, 7490, 5880, 4270, 2640, 1030, 0, 0, 0, 45500),
(278000, 281000, 7610, 5990, 4370, 2760, 1140, 0, 0, 0, 46600),
(281000, 284000, 7710, 6100, 4480, 2860, 1250, 0, 0, 0, 47600),
(284000, 287000, 7820, 6210, 4580, 2970, 1360, 0, 0, 0, 48600),
(287000, 290000, 7920, 6310, 4700, 3070, 1460, 0, 0, 0, 49700),
(290000, 293000, 8040, 6420, 4800, 3190, 1570, 0, 0, 0, 50900),
(293000, 296000, 8140, 6520, 4910, 3290, 1670, 0, 0, 0, 52100),
(296000, 299000, 8250, 6640, 5010, 3400, 1790, 160, 0, 0, 52900),
(299000, 302000, 8420, 6740, 5130, 3510, 1890, 280, 0, 0, 53700),
(302000, 305000, 8670, 6860, 5250, 3630, 2010, 400, 0, 0, 54500),
(305000, 308000, 8910, 6980, 5370, 3760, 2130, 520, 0, 0, 55200),
(308000, 311000, 9160, 7110, 5490, 3880, 2260, 640, 0, 0, 56100),
(311000, 314000, 9400, 7230, 5620, 4000, 2380, 770, 0, 0, 56900),
(314000, 317000, 9650, 7350, 5740, 4120, 2500, 890, 0, 0, 57800),
(317000, 320000, 9890, 7470, 5860, 4250, 2620, 1010, 0, 0, 58800),
(320000, 323000, 10140, 7600, 5980, 4370, 2750, 1130, 0, 0, 59800),
(323000, 326000, 10380, 7720, 6110, 4490, 2870, 1260, 0, 0, 60900),
(326000, 329000, 10630, 7840, 6230, 4610, 2990, 1380, 0, 0, 61900),
(329000, 332000, 10870, 7960, 6350, 4740, 3110, 1500, 0, 0, 62900),
(332000, 335000, 11120, 8090, 6470, 4860, 3240, 1620, 0, 0, 63900),
(335000, 338000, 11360, 8210, 6600, 4980, 3360, 1750, 130, 0, 64900),
(338000, 341000, 11610, 8370, 6720, 5110, 3480, 1870, 260, 0, 66000),
(341000, 344000, 11850, 8620, 6840, 5230, 3600, 1990, 380, 0, 67000),
(344000, 347000, 12100, 8860, 6960, 5350, 3730, 2110, 500, 0, 68000),
(347000, 350000, 12340, 9110, 7090, 5470, 3850, 2240, 620, 0, 69000),
(350000, 353000, 12590, 9350, 7210, 5600, 3970, 2360, 750, 0, 70000),
(353000, 356000, 12830, 9600, 7330, 5720, 4090, 2480, 870, 0, 71100),
(356000, 359000, 13080, 9840, 7450, 5840, 4220, 2600, 990, 0, 72100),
(359000, 362000, 13320, 10090, 7580, 5960, 4340, 2730, 1110, 0, 73100),
(362000, 365000, 13570, 10330, 7700, 6090, 4460, 2850, 1240, 0, 74200),
(365000, 368000, 13810, 10580, 7820, 6210, 4580, 2970, 1360, 0, 75200),
(368000, 371000, 14060, 10820, 7940, 6330, 4710, 3090, 1480, 0, 76200),
(371000, 374000, 14300, 11070, 8070, 6450, 4830, 3220, 1600, 0, 77100),
(374000, 377000, 14550, 11310, 8190, 6580, 4950, 3340, 1730, 100, 78100),
(377000, 380000, 14790, 11560, 8320, 6700, 5070, 3460, 1850, 220, 79000),
(380000, 383000, 15040, 11800, 8570, 6820, 5200, 3580, 1970, 350, 79900),
(383000, 386000, 15280, 12050, 8810, 6940, 5320, 3710, 2090, 470, 81400),
(386000, 389000, 15530, 12290, 9060, 7070, 5440, 3830, 2220, 590, 83100),
(389000, 392000, 15770, 12540, 9300, 7190, 5560, 3950, 2340, 710, 84700),
(392000, 395000, 16020, 12780, 9550, 7310, 5690, 4070, 2460, 840, 86500),
(395000, 398000, 16260, 13030, 9790, 7430, 5810, 4200, 2580, 960, 88200),
(398000, 401000, 16510, 13270, 10040, 7560, 5930, 4320, 2710, 1080, 89800),
(401000, 404000, 16750, 13520, 10280, 7680, 6050, 4440, 2830, 1200, 91600),
(404000, 407000, 17000, 13760, 10530, 7800, 6180, 4560, 2950, 1330, 93300),
(407000, 410000, 17240, 14010, 10770, 7920, 6300, 4690, 3070, 1450, 95000),
(410000, 413000, 17490, 14250, 11020, 8050, 6420, 4810, 3200, 1570, 96700),
(413000, 416000, 17730, 14500, 11260, 8170, 6540, 4930, 3320, 1690, 98300),
(416000, 419000, 17980, 14740, 11510, 8290, 6670, 5050, 3440, 1820, 100100),
(419000, 422000, 18220, 14990, 11750, 8530, 6790, 5180, 3560, 1940, 101800),
(422000, 425000, 18470, 15230, 12000, 8770, 6910, 5300, 3690, 2060, 103400),
(425000, 428000, 18710, 15480, 12240, 9020, 7030, 5420, 3810, 2180, 105200),
(428000, 431000, 18960, 15720, 12490, 9260, 7160, 5540, 3930, 2310, 106900),
(431000, 434000, 19210, 15970, 12730, 9510, 7280, 5670, 4050, 2430, 108500),
(434000, 437000, 19450, 16210, 12980, 9750, 7400, 5790, 4180, 2550, 110300),
(437000, 440000, 19700, 16460, 13220, 10000, 7520, 5910, 4300, 2680, 112000),
(440000, 443000, 20090, 16700, 13470, 10240, 7650, 6030, 4420, 2800, 113600),
(443000, 446000, 20580, 16950, 13710, 10490, 7770, 6160, 4540, 2920, 115400),
(446000, 449000, 21070, 17190, 13960, 10730, 7890, 6280, 4670, 3040, 117100),
(449000, 452000, 21560, 17440, 14200, 10980, 8010, 6400, 4790, 3170, 118700),
(452000, 455000, 22050, 17680, 14450, 11220, 8140, 6520, 4910, 3290, 120500),
(455000, 458000, 22540, 17930, 14690, 11470, 8260, 6650, 5030, 3410, 122200),
(458000, 461000, 23030, 18170, 14940, 11710, 8470, 6770, 5160, 3530, 123800),
(461000, 464000, 23520, 18420, 15180, 11960, 8720, 6890, 5280, 3660, 125600),
(464000, 467000, 24010, 18660, 15430, 12200, 8960, 7010, 5400, 3780, 127300),
(467000, 470000, 24500, 18910, 15670, 12450, 9210, 7140, 5520, 3900, 129000),
(470000, 473000, 24990, 19150, 15920, 12690, 9450, 7260, 5650, 4020, 130700),
(473000, 476000, 25480, 19400, 16160, 12940, 9700, 7380, 5770, 4150, 132300),
(476000, 479000, 25970, 19640, 16410, 13180, 9940, 7500, 5890, 4270, 134000),
(479000, 482000, 26460, 20000, 16650, 13430, 10190, 7630, 6010, 4390, 135600),
(482000, 485000, 26950, 20490, 16900, 13670, 10430, 7750, 6140, 4510, 137200),
(485000, 488000, 27440, 20980, 17140, 13920, 10680, 7870, 6260, 4640, 138800),
(488000, 491000, 27930, 21470, 17390, 14160, 10920, 7990, 6380, 4760, 140400),
(491000, 494000, 28420, 21960, 17630, 14410, 11170, 8120, 6500, 4880, 142000),
(494000, 497000, 28910, 22450, 17880, 14650, 11410, 8240, 6630, 5000, 143700),
(497000, 500000, 29400, 22940, 18120, 14900, 11660, 8360, 6750, 5130, 145200),
(500000, 503000, 29890, 23430, 18370, 15140, 11900, 8670, 6870, 5250, 146800),
(503000, 506000, 30380, 23920, 18610, 15390, 12150, 8910, 6990, 5370, 148500),
(506000, 509000, 30880, 24410, 18860, 15630, 12390, 9160, 7120, 5490, 150100),
(509000, 512000, 31370, 24900, 19100, 15880, 12640, 9400, 7240, 5620, 151600),
(512000, 515000, 31860, 25390, 19350, 16120, 12890, 9650, 7360, 5740, 153300),
(515000, 518000, 32350, 25880, 19590, 16370, 13130, 9890, 7480, 5860, 154900),
(518000, 521000, 32840, 26370, 19840, 16610, 13380, 10140, 7610, 5980, 156500),
(521000, 524000, 33330, 26860, 20080, 16860, 13620, 10380, 7730, 6110, 158100),
(524000, 527000, 33820, 27350, 20330, 17100, 13870, 10630, 7850, 6230, 159600),
(527000, 530000, 34310, 27840, 20570, 17350, 14110, 10870, 7970, 6350, 161000),
(530000, 533000, 34800, 28330, 20820, 17590, 14360, 11120, 8100, 6470, 162500),
(533000, 536000, 35290, 28820, 21060, 17840, 14600, 11360, 8220, 6600, 164000),
(536000, 539000, 35780, 29310, 21310, 18080, 14850, 11610, 8350, 6720, 165400),
(539000, 542000, 36270, 29800, 21550, 18330, 15090, 11850, 8470, 6840, 166900),
(542000, 545000, 36760, 30290, 21800, 18570, 15340, 12100, 8600, 6960, 168400),
(545000, 548000, 37250, 30780, 22050, 18820, 15580, 12340, 8720, 7090, 169900),
(548000, 551000, 37740, 31270, 22290, 19060, 15830, 12590, 8850, 7210, 171300),
(551000, 554000, 38230, 31810, 22540, 19310, 16070, 12830, 8970, 7330, 172800),
(554000, 557000, 38830, 32370, 22780, 19550, 16320, 13080, 9100, 7460, 174300),
(557000, 560000, 39380, 32920, 23030, 19800, 16560, 13320, 9220, 7580, 175700),
(560000, 563000, 39930, 33470, 23270, 20050, 16810, 13570, 9350, 7700, 177200),
(563000, 566000, 40480, 34020, 23520, 20290, 17050, 13810, 9470, 7830, 178700),
(566000, 569000, 41030, 34570, 23760, 20540, 17300, 14060, 9600, 7950, 180100),
(569000, 572000, 41590, 35120, 24010, 20780, 17540, 14300, 9720, 8070, 181600),
(572000, 575000, 42140, 35670, 24250, 21030, 17790, 14550, 9850, 8200, 183100),
(575000, 578000, 42690, 36230, 24500, 21270, 18030, 14790, 9970, 8320, 184600),
(578000, 581000, 43240, 36780, 24740, 21520, 18280, 15040, 10100, 8440, 186000),
(581000, 584000, 43790, 37330, 24990, 21760, 18520, 15280, 10220, 8570, 187500),
(584000, 587000, 44340, 37880, 25230, 22010, 18770, 15530, 10350, 8690, 189000),
(587000, 590000, 44890, 38430, 25480, 22250, 19010, 15770, 10470, 8820, 190400)
